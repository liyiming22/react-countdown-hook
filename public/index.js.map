{"version":3,"file":"index.js","sources":["../src/index.tsx"],"sourcesContent":["import { useCallback, useEffect, useRef, useState } from 'react'\n\nexport const START_TIME = '00'\n\nexport interface ITimerProps {\n  timeLeft: number\n  requestRef?: ReturnType<typeof window.requestAnimationFrame>\n  startedTime?: number\n  lastInterval?: number\n}\n\nexport interface ITimeRemain {\n  dd: string\n  hh: string\n  mm: string\n  ss: string\n}\n\nexport type UseCountDown = (initialRemain: number, startImmediately?: boolean) => [ITimeRemain, () => void]\n\nconst formatTimeString = (n: number) => Math.floor(n).toString().padStart(2, '0')\n\nconst useCountDown: UseCountDown = (initialTime, startImmediately = true) => {\n  const timer = useRef<ITimerProps>({ timeLeft: initialTime })\n  const [timeRemain, setTimeRemain] = useState<ITimeRemain>({\n    dd: START_TIME,\n    hh: START_TIME,\n    mm: START_TIME,\n    ss: START_TIME\n  })\n\n  const updateTime = useCallback((currTs: number) => {\n    const days = currTs / 1000 / 60 / 60 / 24\n\n    const hours = currTs / 1000 / 60 / 60 - (24 * Math.floor(days))\n\n    const minutes = currTs / 1000 / 60 - (24 * 60 * Math.floor(days)) - (60 * Math.floor(hours))\n\n    const seconds = currTs / 1000 - (24 * 60 * 60 * Math.floor(days)) - (60 * 60 * Math.floor(hours)) - (60 * Math.floor(minutes))\n\n    setTimeRemain({\n      dd: Math.floor(days).toString(),\n      hh: formatTimeString(hours),\n      mm: formatTimeString(minutes),\n      ss: formatTimeString(seconds)\n    })\n\n  }, [])\n\n  const run: FrameRequestCallback = ts => {\n    if (!timer.current.startedTime || !timer.current.lastInterval) {\n      timer.current.startedTime = ts\n      timer.current.lastInterval = ts\n    }\n\n    const currElapsed = Math.min(1000, timer.current.timeLeft)\n    if (currElapsed <= ts - timer.current.lastInterval) {\n      timer.current.lastInterval += currElapsed\n      timer.current.timeLeft -= currElapsed\n      updateTime(timer.current.timeLeft)\n    }\n\n    if (0 < timer.current.timeLeft) {\n      timer.current.requestRef = window.requestAnimationFrame(run)\n    } else {\n      timer.current = { timeLeft: 0 }\n    }\n  }\n\n  const start = useCallback(() => {\n    if ('number' === typeof timer.current.requestRef) {\n      window.cancelAnimationFrame(timer.current.requestRef)\n    }\n\n    timer.current.requestRef = window.requestAnimationFrame(run)\n  }, [])\n\n  useEffect(() => {\n    if (startImmediately) {\n      start()\n    }\n  }, [])\n\n  return [ timeRemain, start ]\n}\n\nexport default useCountDown\n"],"names":[],"mappings":"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"}